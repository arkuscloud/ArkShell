#100DaysOfCode - #100DaysOfPowerShell - Day 1 Transcript
**********************
Windows PowerShell transcript start
Start time: 20211105214911
Username: CAMPACTION\Solo
RunAs User: CAMPACTION\Solo
Configuration Name: 
Machine: CAMPACTION (Microsoft Windows NT 10.0.19043.0)
Host Application: C:\Windows\System32\WindowsPowerShell\v1.0\powershell.exe
Process ID: 14320
PSVersion: 5.1.19041.1237
PSEdition: Desktop
PSCompatibleVersions: 1.0, 2.0, 3.0, 4.0, 5.0, 5.1.19041.1237
BuildVersion: 10.0.19041.1237
CLRVersion: 4.0.30319.42000
WSManStackVersion: 3.0
PSRemotingProtocolVersion: 2.3
SerializationVersion: 1.1.0.1
**********************
Transcript started, output file is C:\Users\Solo\OneDrive - arkuscloud\Documents\PowerShell_transcript.CAMPACTION.zPsLSxpR.20211105214911.txt
PS C:\WINDOWS\system32> Install-Module -Name AzureAD
Untrusted repository
You are installing the modules from an untrusted repository. If you trust this repository, change its InstallationPolicy value by running the Set-PSRepository cmdlet. Are you sure you want to install the modules from 'PSGallery'?
&Yes  Yes to &All  &No  No to A&ll  &Suspend
A
PS C:\WINDOWS\system32> Connect-AzureAD -AccountId solan@arkuscloud.io

Account             Environment TenantId                             TenantDomain  AccountType
-------             ----------- --------                             ------------  -----------
solan@arkuscloud.io AzureCloud  YourTenantID arkuscloud.io User


PS C:\WINDOWS\system32> $PasswordProfile = New-Object -TypeName Microsoft.Open.AzureAD.Model.PasswordProfile
PS C:\WINDOWS\system32> $PasswordProfile.Password = "YourPassword"
PS C:\WINDOWS\system32> $PasswordProfile.EnforceChangePasswordPolicy = $true

#create New AzureAD User
PS C:\WINDOWS\system32> New-AzureADUser -DisplayName "Bootsy Rawlings" -PasswordProfile $PasswordProfile -UserPrincipalName "brawlings@arkuscloud.io" -AccountEnabled $true -MailNickName "BRawlings"

ObjectId                             DisplayName     UserPrincipalName       UserType
--------                             -----------     -----------------       --------
aab84950-1e8f-4c59-8903-632f9be37155 Bootsy Rawlings brawlings@arkuscloud.io Member


#Checking help file for example use of command
PS C:\WINDOWS\system32> help New-AzureADGroup -Examples

NAME
    New-AzureADGroup

SYNOPSIS
    Creates a group.


    Example 1: Create a group

    PS C:\>New-AzureADGroup -DisplayName "My new group" -MailEnabled $false -SecurityEnabled $true -MailNickName "NotSet"

    ObjectId                             DisplayName  Description
    --------                             -----------  -----------
    11fa5e1e-737c-40c5-835e-416ae3959606 My new group

#Created to Arkus Demo Group
PS C:\WINDOWS\system32> New-AzureADGroup -DisplayName "ArkusDemo" -MailEnabled $False -SecurityEnabled $True -MailNickName "ArkusDemo"

ObjectId                             DisplayName Description
--------                             ----------- -----------
32ebeea2-ef98-4dd5-8521-9af1ac3bf5a3 ArkusDemo

#Removed excess console output
PS C:\WINDOWS\system32> cls

#Error output when adding -All. This is not required for list of Azure AD Users
PS C:\WINDOWS\system32> Get-AzureADUser -All
>> TerminatingError(Get-AzureADUser): "Missing an argument for parameter 'All'. Specify a parameter of type 'System.Nullable`1[System.Boolean]' and try again."
Get-AzureADUser : Missing an argument for parameter 'All'. Specify a parameter of type 
'System.Nullable`1[System.Boolean]' and try again.
At line:1 char:17
+ Get-AzureADUser -All
+                 ~~~~
    + CategoryInfo          : InvalidArgument: (:) [Get-AzureADUser], ParameterBindingException
    + FullyQualifiedErrorId : MissingArgument,Microsoft.Open.AzureAD16.PowerShell.GetUser
Get-AzureADUser : Missing an argument for parameter 'All'. Specify a parameter of type 'System.Nullable`1[System.Boolean]' and try again.
At line:1 char:17
+ Get-AzureADUser -All
+                 ~~~~
    + CategoryInfo          : InvalidArgument: (:) [Get-AzureADUser], ParameterBindingException
    + FullyQualifiedErrorId : MissingArgument,Microsoft.Open.AzureAD16.PowerShell.GetUser


#Successful output of Azure AD Users
PS C:\WINDOWS\system32> Get-AzureADUser 

ObjectId                             DisplayName     UserPrincipalName              UserType
--------                             -----------     -----------------              --------
aab84950-1e8f-4c59-8903-632f9be37155 Bootsy Rawlings brawlings@arkuscloud.io        Member
4b45de90-63cc-4cfb-b814-b8f2875dc69a Bruce Leroy     sol@arkuscloud.onmicrosoft.com Member
3e996785-a16f-4f9a-a08c-035afe93e57b Solan White     solan@arkuscloud.io            Member


#filtering console output for easier read
PS C:\WINDOWS\system32> Get-AzureADUser | Select-Object -Property displayname, objectid

DisplayName     ObjectId
-----------     --------
Bootsy Rawlings aab84950-1e8f-4c59-8903-632f9be37155
Bruce Leroy     4b45de90-63cc-4cfb-b814-b8f2875dc69a
Solan White     3e996785-a16f-4f9a-a08c-035afe93e57b

#One way to locate the GUID of a user
PS C:\WINDOWS\system32> Get-AzureADUser -ObjectId solan@arkuscloud.io

ObjectId                             DisplayName UserPrincipalName   UserType
--------                             ----------- -----------------   --------
3e996785-a16f-4f9a-a08c-035afe93e57b Solan White solan@arkuscloud.io Member

#Another way to narrow down only the desired output of object id GUID
PS C:\WINDOWS\system32> (Get-AzureADUser -ObjectId solan@arkuscloud.io).objectid
3e996785-a16f-4f9a-a08c-035afe93e57b

#Listing all groups in AzureAD
PS C:\WINDOWS\system32> Get-AzureADGroup

ObjectId                             DisplayName Description
--------                             ----------- -----------
076acc9c-dcaf-4dc5-9a71-cab01b68c261 All Company This is the default group for everyone in the network
2a26cef9-b2f3-45cd-9eb9-e6468bf6c9a6 ArkusDemo   ArkusDemo
32ebeea2-ef98-4dd5-8521-9af1ac3bf5a3 ArkusDemo
dfad0848-6edd-48f0-aa71-b92b84032298 Projects    Projects
e4b9b00f-0d01-47cf-aee1-5c4c026e0d2b Playbook    Playbook

#It would help if I included the dash before example (see next successful attempt)
PS C:\WINDOWS\system32> help Remove-AzureADGroup example
>> TerminatingError(help): "A positional parameter cannot be found that accepts argument 'example'."
help : A positional parameter cannot be found that accepts argument 'example'.
At line:1 char:1
+ help Remove-AzureADGroup example
+ ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
    + CategoryInfo          : InvalidArgument: (:) [help], ParameterBindingException
    + FullyQualifiedErrorId : PositionalParameterNotFound,help
help : A positional parameter cannot be found that accepts argument 'example'.
At line:1 char:1
+ help Remove-AzureADGroup example
+ ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
    + CategoryInfo          : InvalidArgument: (:) [help], ParameterBindingException
    + FullyQualifiedErrorId : PositionalParameterNotFound,help

#listing examples of the Remove-AzureADGroup cmdlet
PS C:\WINDOWS\system32> help Remove-AzureADGroup -Examples

NAME
    Remove-AzureADGroup

SYNOPSIS
    Removes a group.


    Example 1: Remove a group

    PS C:\>Remove-AzureADGroup -ObjectId "11fa5e1e-737c-40c5-835e-416ae3959606"

    This command removes the specified group from Azure AD.

#Removing the duplicate group entry
PS C:\WINDOWS\system32> Remove-AzureADGroup -ObjectId 32ebeea2-ef98-4dd5-8521-9af1ac3bf5a3

#Confirming the duplicate group has been removed
PS C:\WINDOWS\system32> Get-AzureADGroup

ObjectId                             DisplayName Description
--------                             ----------- -----------
076acc9c-dcaf-4dc5-9a71-cab01b68c261 All Company This is the default group for everyone in the network
2a26cef9-b2f3-45cd-9eb9-e6468bf6c9a6 ArkusDemo   ArkusDemo
dfad0848-6edd-48f0-aa71-b92b84032298 Projects    Projects
e4b9b00f-0d01-47cf-aee1-5c4c026e0d2b Playbook    Playbook


#Creating new AzureADGroup
PS C:\WINDOWS\system32> New-AzureADGroup -Description "ArkShell" -DisplayName "ArkShell" -MailEnabled $false -SecurityEnabled $true -MailNickName "ArkShell"

ObjectId                             DisplayName Description
--------                             ----------- -----------
ed1f1090-e3ea-4378-9152-62a3f4d7f4ee ArkShell    ArkShell


#Adding group member to Azure Group
PS C:\WINDOWS\system32> Add-AzureADGroupMember -ObjectId "ed1f1090-e3ea-4378-9152-62a3f4d7f4ee" -RefObjectId "4b45de90-63cc-4cfb-b814-b8f2875dc69a"

#Checking group to confirm group membership
PS C:\WINDOWS\system32> Get-AzureADGroupMember -ObjectId "ed1f1090-e3ea-4378-9152-62a3f4d7f4ee"

ObjectId                             DisplayName UserPrincipalName              UserType
--------                             ----------- -----------------              --------
4b45de90-63cc-4cfb-b814-b8f2875dc69a Bruce Leroy sol@arkuscloud.onmicrosoft.com Member

#Disconnect Session
PS C:\WINDOWS\system32> Disconnect-AzureAD
PS C:\WINDOWS\system32> Stop-Transcript
**********************
Windows PowerShell transcript end
End time: 20211105223610
**********************
